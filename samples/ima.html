<!DOCTYPE html>
<html>
  <head>
    <!-- Videojs -->
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/7.20.3/video.js"></script>
    <!-- ima -->
    <script src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <!-- contrib-ads -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.9.0/videojs.ads.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.9.0/videojs.ads.min.js"></script>
    <!-- videojs + ima -->
    <link
      href="../node_modules/videojs-ima/dist/videojs.ima.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="../node_modules/videojs-ima/dist/videojs.ima.js"></script>
    <style>
      .vjs-ad-playing.vjs-ad-playing .vjs-control-bar {
        display: none;
      }
    </style>
    <!-- newrelic browser agent. REMEMBER TO REPLACE THIS SCRIPT WITH YOUR OWN BROWSER AGENT -->
    <script type="text/javascript" src="agent.js"></script>
    <!-- New Relic Tracker -->
    <script src="../dist/newrelic-video-videojs.min.js"></script>
  </head>

  <body>
    <video
      id="myVideo"
      class="video-js vjs-default-skin"
      height="640px"
      width="480px"
      controls
    >
      <source
        src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
      />
    </video>
    <script>
      //PLAYER
      var player = videojs('myVideo');

      // defining new relic videojs tracker

      //const tracker = new nrvideo.VideojsTracker(player, { heartbeat: 60000 });
      const tracker = new nrvideo.VideojsTracker(player);

      //NEWRELIC
      nrvideo.Core.addTracker(tracker);

      // IMA3
      // pre mid post roll
      player.ima(
        {
          id: 'myVideo',
          adTagUrl:
            'https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/vmap_ad_samples&sz=640x480&cust_params=sample_ar%3Dpremidpost&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=',
        }
        // player.ima.start
      );

      // pre roll
      // player.ima(
      //   {
      //     id: 'myVideo',
      //     adTagUrl:
      //       'https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/vmap_ad_samples&sz=640x480&cust_params=sample_ar%3Dpreonly&ciu_szs=300x250%2C728x90&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&correlator=',
      //   }
      //   // player.ima.start
      // );

      // pre Roll multiple mid roll and post roll
      // player.ima(
      //   {
      //     id: 'myVideo',
      //     adTagUrl:
      //       'https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/vmap_ad_samples&sz=640x480&cust_params=sample_ar%3Dpremidpostlongpod&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=',
      //   }
      //   // player.ima.start
      // );

      player.one('click', () => {
        player.play(); // Only call play to start the video after user interaction
      });

      player.ima.initializeAdDisplayContainer();
      player.ima.requestAds();
      player.ima.start();
    </script>
  </body>
</html>
