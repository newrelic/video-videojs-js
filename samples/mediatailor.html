<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New Relic VideoJS Tracker with AWS MediaTailor</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  </head>
  <body>
    <h1>New Relic VideoJS Tracker with AWS MediaTailor</h1>

    <video
      id="my-player"
      class="video-js"
      controls
      preload="auto"
      width="640"
      height="360"
      data-setup="{}"
    ></video>

    <!-- 1. Include Video.js -->
    <script src="https://vjs.zencdn.net/8.10.0/video.js"></script>

    <!-- 2. Include the New Relic Video Agent -->
    <!-- This file is generated by the 'npm run build' command -->
    <script src="../dist/umd/newrelic-video-videojs.min.js"></script>

    <script>
      // Enable debug logging
      console.log('Starting MediaTailor sample...');
      
      // 3. Set up New Relic tracker options
      const nrOptions = {
        info: {
          beacon: 'bam.nr-data.net',
          applicationID: '601599692',
          licenseKey: 'NRBR-5276ec87a4a0c11f5fa',
        },
      };

      // 4. Initialize the player
      var player = videojs('my-player');
      console.log('Player initialized:', player);

      // 5. Initialize the New Relic tracker with the player and options
      //   newrelic.video.track(player, nrOptions);
      const tracker = new VideojsTracker(player, nrOptions);
      console.log('Tracker initialized:', tracker);

      // 6. Set the MediaTailor stream URL as the source
      // The tracker will automatically detect it and start tracking ads.
      player.src({
        src: 'https://2d271f758c9940e882092aed7e4451c4.mediatailor.ap-southeast-2.amazonaws.com/v1/master/54ad5836d26bc9938d9793caa9fe55e611da7d60/my-playback-config/master.m3u8',
        type: 'application/x-mpegURL',
      });
      
      console.log('Source set, current src:', player.currentSrc());
      
    </script>
  </body>
</html>
